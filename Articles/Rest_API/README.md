

# Что такое REST API

## Ссылки


- [Что такое REST API](https://github.com/Xpom1/Articles/blob/main/Articles/Rest_API/README.md#%D1%87%D1%82%D0%BE-%D1%82%D0%B0%D0%BA%D0%BE%D0%B5-rest-api)
- [Принципы архитектурного стиля REST](https://github.com/Xpom1/Articles/blob/main/Articles/Rest_API/README.md#%D0%BF%D1%80%D0%B8%D0%BD%D1%86%D0%B8%D0%BF%D1%8B-%D0%B0%D1%80%D1%85%D0%B8%D1%82%D0%B5%D0%BA%D1%82%D1%83%D1%80%D0%BD%D0%BE%D0%B3%D0%BE-%D1%81%D1%82%D0%B8%D0%BB%D1%8F-rest)
- [Преимущества REST API](https://github.com/Xpom1/Articles/blob/main/Articles/Rest_API/README.md#%D0%BF%D1%80%D0%B5%D0%B8%D0%BC%D1%83%D1%89%D0%B5%D1%81%D1%82%D0%B2%D0%B0-rest-api)
- [Как работает RESTful API?](https://github.com/Xpom1/Articles/blob/main/Articles/Rest_API/README.md#%D0%BA%D0%B0%D0%BA-%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0%D0%B5%D1%82-restful-api)
- [Что содержит клиентский запрос RESTful API?](https://github.com/Xpom1/Articles/blob/main/Articles/Rest_API/README.md#%D1%87%D1%82%D0%BE-%D1%81%D0%BE%D0%B4%D0%B5%D1%80%D0%B6%D0%B8%D1%82-%D0%BA%D0%BB%D0%B8%D0%B5%D0%BD%D1%82%D1%81%D0%BA%D0%B8%D0%B9-%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81-restful-api)
- [Название своих REST сервисов](https://github.com/Xpom1/Articles/blob/main/Articles/Rest_API/README.md#%D0%BD%D0%B0%D0%B7%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D1%81%D0%B2%D0%BE%D0%B8%D1%85-rest-%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%BE%D0%B2)
- [Ответ сервера RESTful API](https://github.com/Xpom1/Articles/blob/main/Articles/Rest_API/README.md#%D0%BE%D1%82%D0%B2%D0%B5%D1%82-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B0-restful-api)
- [Стандарты](https://github.com/Xpom1/Articles/blob/main/Articles/Rest_API/README.md#%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%8B)
---

Термин REST был введен в 2000 году Роем Филдингом, одним из авторов HTTP-протокола.
REST (Representational State Transfer) — это набор принципов и соглашений, используемых для создания веб-сервисов и
взаимодействия между клиентами и серверами в распределенной сети, такой как Интернет.

------------

## Принципы архитектурного стиля REST

##### Единый интерфейс

Единый интерфейс в архитектуре RESTful обеспечивает стандартизированный способ взаимодействия между клиентом и сервером.
Он предусматривает передачу информации в формате представления, который может отличаться от внутреннего представления
ресурса на сервере. Клиенты могут идентифицировать ресурсы по уникальному URL и выполнять действия над ними с
использованием базовых методов протокола HTTP.

##### Отсутствие сохранения состояния

В соответствии с архитектурой REST, сервер не хранит на стороне сервера никаких данных о клиентской сессии. Это
ограничение называется Statelessness.

Каждый запрос от клиента к серверу должен содержать всю необходимую информацию для понимания запроса. Сервер не может
воспользоваться каким-либо хранящимся на сервере контекстом.

Поэтому состояние сессии приложения полностью хранится на клиенте. Клиент отвечает за хранение и обработку информации,
связанной с сессией, на своей стороне.

Это также означает, что клиент отвечает за отправку любой информации о состоянии на сервер, когда это необходимо. Между
клиентом и сервером не должно быть никакой привязки к сеансу или "липкого" сеанса.

##### Многоуровневая система

В многоуровневой системной архитектуре клиент может подключаться к другим авторизованным посредникам между клиентом и
сервером и по-прежнему получать ответы от сервера. Серверы также могут передавать запросы другим серверам.

##### Емкость кэша

Веб-службы RESTful поддерживают кэширование, то есть процесс сохранения некоторых ответов на клиенте или на посреднике
для сокращения времени ответа сервера.

##### Код по запросу

В архитектурном стиле REST серверы могут временно расширять или настраивать функциональные возможности клиента,
передавая код программного обеспечения.

## Преимущества REST API

##### Возможность масштабирования

Системы, реализующие REST API, могут эффективно масштабироваться благодаря оптимизации взаимодействия между сервером и
клиентом по REST. Отсутствие сохранения состояния снимает нагрузку с сервера: серверу не нужно сохранять информацию о
предыдущих запросах клиента. Отлаженное кэширование частично или полностью устраняет некоторые взаимодействия между
клиентом и сервером. Перечисленные функции предполагают масштабируемость и не ограничивают пропускную способность, что
может привести к снижению производительности.

##### Гибкость

Веб-службы RESTful поддерживают полное разделение клиента и сервера. Они упрощают и разделяют различные серверные
компоненты, чтобы каждая часть могла развиваться независимо. Изменения платформы или технологии в серверном приложении
не влияют на клиентское приложение. Возможность разделения функций приложения на уровни еще больше повышает гибкость.
Например, разработчики могут вносить изменения в уровень базы данных, не переписывая логику приложения.

##### Независимость

REST API не зависит от используемой технологии. Вы можете создавать как клиентские, так и серверные приложения на разных
языках программирования, не затрагивая структуру API. Также можно изменить базовую технологию на любой стороне, не влияя
на обмен данными.

## Как работает RESTful API?

Базовый принцип работы RESTful API совпадает с принципом работы в Интернете. Клиент связывается с сервером с помощью
API, когда ему требуется какой-либо ресурс. Разработчики описывают принцип использования REST API клиентом в
документации на API серверного приложения. Ниже представлены основные этапы запроса REST API:

1. Клиент отправляет запрос на сервер. Руководствуясь документацией API, клиент форматирует запрос таким образом, чтобы
   его понимал сервер.
2. Сервер аутентифицирует клиента и подтверждает, что клиент имеет право сделать этот запрос.
3. Сервер получает запрос и внутренне обрабатывает его.
4. Сервер возвращает ответ клиенту. Ответ содержит информацию, которая сообщает клиенту, был ли запрос успешным. Также
   запрос включает сведения, запрошенные клиентом.

Сведения о запросе и ответе REST API могут немного различаться в зависимости от того, как разработчики проектируют API.

## Что содержит клиентский запрос RESTful API?

##### Уникальный идентификатор ресурса

Сервер присваивает каждому ресурсу уникальный идентификатор ресурса. В случае со службами REST сервер идентифицирует
ресурсы с помощью универсального указателя ресурсов (URL). URL указывает путь к ресурсу. URL аналогичен адресу
веб-сайта, который вы вводите в браузере для посещения веб-страницы. URL также называется адресом запроса и четко
указывает серверу, что требуется клиенту.

##### Метод

Как правило, разработчики реализуют RESTful API с помощью протокола передачи гипертекста (HTTP). Метод HTTP сообщает
серверу, что ему необходимо сделать с ресурсом. Ниже приведены четыре распространенных метода HTTP:

- **GET**

Клиенты используют GET для доступа к ресурсам, расположенным на сервере по указанному URL. Они могут кэшировать запросы
GET и отправлять параметры в запросе RESTful API, чтобы сообщить серверу о необходимости фильтровать данные перед
отправкой.

*Запрос:*
> GET /index.php HTTP/1.1
> Host: example.com
> User-Agent: Mozilla/5.0 (X11; U; Linux i686; ru; rv:1.9b5) Gecko/2008050509 Firefox/3.0b5
> Accept: text/html
> Connection: close

Первая строка — это строка запроса, остальные — заголовки; тело сообщения отсутствует

*Ответ:*

> HTTP/1.0 200 OK
> Server: nginx/0.6.31
> Content-Language: ru
> Content-Type: text/html; charset=utf-8
> Content-Length: 1234
> Connection: close
> ... САМА HTML-СТРАНИЦА ...

- **POST**

Клиенты используют POST для отправки данных на сервер. При этом они включают в запрос представления данных. Отправка
одного и того же запроса POST несколько раз имеет побочный эффект — многократное создание одного и того же ресурса.

- **PUT**

Клиенты используют PUT для обновления существующих на сервере ресурсов. В отличие от POST, отправка одного и того же
запроса PUT несколько раз дает один и тот же результат в веб-службе RESTful.

- **DELETE**

Клиенты используют запрос DELETE для удаления ресурса. Запрос DELETE может изменить состояние сервера. Однако если у
пользователя нет соответствующей аутентификации, запрос завершается ошибкой.

- **Заголовки HTTP**

Заголовки запросов — это метаданные, которыми обмениваются клиент и сервер. Например, заголовок запроса указывает формат
запроса и ответа, предоставляет информацию о статусе запроса и т. д. В HTTP-заголовке содержится не чувствительное к
регистру название, а затем после (:) непосредственно значение.

*Пример заголовка: *

> GET /tutorials/other/top-20-mysql-best-practices/ HTTP/1.1
> Host: net.tutsplus.com
> User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.5) Gecko/20091102 Firefox/3.5.5 (.NET CLR
> 3.5.30729)
> Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
> Accept-Language: en-us,en;q=0.5
> Accept-Encoding: gzip,deflate
> Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
> Keep-Alive: 300
> Connection: keep-alive
> Cookie: PHPSESSID=r2t5uvjq435r4q7ib3vtdjq120
> Pragma: no-cache
> Cache-Control: no-cache

## Название своих REST сервисов

Используйте множественное число для названия своих REST сервисов. Это еще одна горячая тема для обсуждений среди REST
дизайнеров – выбор между единственными или множественными формами существительных для обозначения сервисов.

Best Practice:

• /farmers
• /farmers/{farmer_id}
• /crops
• /crops/{crop_id}

Не рекомендуется:

• /farmer
• /farmer/{farmer_id}

*Примечание:
Хотя я упоминаю, что использование множественного числа является best practice, по какой-то причине, если вы
придерживаетесь единственного числа, то придерживайтесь этого во всех своих сервисах. Не смешивайте использование
множественного и единственного чисел. Поэтому я и не говорю здесь про bad practice, а просто говорю, что это не
рекомендуется.*

Ниже приведены советы названию сервисов:

- Используйте существительные для представления ресурсов
- Используйте косую черту (/) для обозначения иерархических отношений
- Не используйте завершающую косую черту (/) в URI.
- Используйте дефисы (-), чтобы улучшить читаемость URI.
- Используйте строчные буквы в URI
- Никогда не используйте имена функций CRUD в URI
- Используйте компонент запроса для фильтрации коллекции URI

## Ответ сервера RESTful API

Принципы REST требуют, чтобы ответ сервера содержал следующие компоненты:

##### Строка состояния

Строка состояния содержит трехзначный код состояния, который сообщает об успешном или неудачном выполнении запроса.
Например, коды 2XX указывают на успешное выполнение, а коды 4XX и 5XX — на ошибки. Коды 3XX указывают на перенаправление
URL.

Ниже приведены некоторые распространенные коды состояния:

- 200 ОК — самый популярный и нужный код ответа от сервера. Означает, что запрос со стороны клиента корректный и со
  стороны сервера выполняется без проблем.

- 301 Moved Permanently — указывает на перенаправление с одной страницы на другую. Зачастую 301 редирект настраивают для
  смены URL страницы с сохранением трафика.

- 302 Found — код для обозначения временного перенаправления.

- 400 Bad Request — указывает на синтаксическую ошибку в запросе со стороны пользователя.

- 401 Unauthorized — указывает на ошибку авторизации пользователя.

- 403 Forbidden — доступ запрещен. Сервер не выполнит запрос из-за дополнительных ограничений.

- 404 Not Found — указывает, что запрашиваемый URL не найден или не существует.

- 500 Internal Server Error — любая внутренняя ошибка сервера. Может быть вызвана неверной настройкой конфигурации.

- 502 Bad Gateway — эта ошибка означает, что сервер во время работы в качестве шлюза для получения ответа, нужного для
  обработки запроса, получил недействительный (недопустимый) ответ.

- 503 Service Unavailable — ошибка возникает при очень большом количестве запросов к серверу, которые он не смог
  выполнить.

- 509 Bandwidth Limit Exceeded — используется при превышении веб-площадкой отведенного ей ограничения на потребление
  трафика. Данные лимиты устанавливаются хостинг-провайдером, и при возникновения данной ошибки нужно обратиться в
  техподдержку.

##### Текст сообщения

Текст ответа содержит представление ресурса. Сервер выбирает подходящий формат представления на основе содержания
заголовков запроса. Клиенты могут запрашивать информацию в форматах XML или JSON: они определяют запись данных в виде
обычного текста. Например, если клиент запрашивает имя и возраст человека по имени Джон, сервер возвращает представление
JSON в следующем формате:
> '{"name":"John", "age":30}'

##### Заголовки

Ответ также содержит заголовки или метаданные об ответе. Они дают более подробный контекст ответа и включают такую
информацию, как название сервера, кодировка, дата и тип контента.

## Стандарты

Обычно в RESTful-сервисах используют стандарт HTTP, а файлы передают в формате JSON или XML.
Пример на JSON

```json
{
  "artists": [
    {
      "artistname": "Deep Purple",
      "formed": "1968",
      "albums": [
        {
          "albumname": "Machine Head",
          "year": "1972",
          "genre": "Рок"
        },
        {
          "albumname": "Stormbringer",
          "year": "1974",
          "genre": "Рок"
        }
      ]
    }
  ]
}
```

Пример на XML

```xml

<artists>
    <artistname>Deep Purple</artistname>
    <formed>1968</formed>
    <albums>
        <album>
            <albumname>Machine Head</albumname>
            <year>1972</year>
            <genre>Рок</genre>
        </album>
        <album>
            <albumname>Stormbringer</albumname>
            <year>1974</year>
            <genre>Рок</genre>
        </album>
    </albums>
</artists>
```